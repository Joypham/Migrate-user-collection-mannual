INSERT into collection_datasource(`CollectionId`, `DatasourceId`, `Priority`, `Ext`, `SourceURI`)
SELECT
	collections.UUID as collection_UUID,
	joy_xinh.datasource_id,
	collection_video.Rank,
	collection_video.Ext,
	videos_youtubeurl.youtubeurl
	
-- 	collections.Title
	
	
-- 	users.UUId as user_UUID,
-- 	collection_video.VideoId,
-- 	collection_video.CollectionId
	FROM
	collections
join users on users.id = collections.UserId and users.Valid > 0
JOIN collection_video on collections.id = collection_video.CollectionId	
join videos on videos.id = collection_video.VideoId
LEFT JOIN videos_youtubeurl on collection_video.VideoId = videos_youtubeurl.VideoId
LEFT JOIN collection_datasource on (collection_datasource.CollectionId = collections.UUID AND collection_datasource.SourceURI = videos_youtubeurl.youtubeurl)

JOIN
-- Table joy_xinh
(
SELECT 
*
from (
SELECT
t1.*,
row_number () over (PARTITION BY t1.SourceURI  ORDER BY t1.datasource_count desc,t1.datasource_priority desc) as row_num
from (
SELECT DISTINCT
datasources.SourceURI,
datasources.id as datasource_id,
datasources.TrackId,
datasources.Formatid,
tracks.title,
tracks.artist,
CAST( trackcountlog.DataSourceCount ->> '$.all' AS UNSIGNED ) AS datasource_count,
if(datasources.Formatid in ('74BA994CF2B54C40946EA62C3979DDA3','1A67A5F1E0D84FB9B48234AE65086375'),10,if(datasources.Formatid <> '',5,1)) as datasource_priority 

FROM
	datasources
join tracks on tracks.id = datasources.TrackId and tracks.Valid = 1
Join itunes_album_tracks_release on itunes_album_tracks_release.TrackName = tracks.Title and itunes_album_tracks_release.TrackArtist = tracks.Artist and itunes_album_tracks_release.Valid = 1
LEFT JOIN trackcountlog on trackcountlog.TrackID = datasources.TrackId 
where
datasources.SourceURI in (
-- điền youtubeurl to find vào đây 
"https://www.youtube.com/watch?v=NKaHNyBmB4E",
"https://www.youtube.com/watch?v=lZ88M2fL2wg",
"https://www.youtube.com/watch?v=pLQEdhCoBE4",
"https://www.youtube.com/watch?v=GlDclqxD4ls",
"https://www.youtube.com/watch?v=IG9ZwLTOqgs",
"https://www.youtube.com/watch?v=BuTy8x1n0lE",
"https://www.youtube.com/watch?v=capJCEUJ7P0",
"https://www.youtube.com/watch?v=UURm6TA_unI",
"https://www.youtube.com/watch?v=LHsVtH0CS7I",
"https://www.youtube.com/watch?v=RSzXK0mUHdg",
"https://www.youtube.com/watch?v=kQYq28kRl7I",
"https://www.youtube.com/watch?v=FKyLW19cyf0",
"https://www.youtube.com/watch?v=EA07noQuUPQ",
"https://www.youtube.com/watch?v=CnkFFbLp2xk",
"https://www.youtube.com/watch?v=gBcDLWs8f2I",
"https://www.youtube.com/watch?v=3pL1plgdPbg",
"https://www.youtube.com/watch?v=NlLZHNVzPsE",
"https://www.youtube.com/watch?v=f0zQkGmSbJk",
"https://www.youtube.com/watch?v=_Ci0Kgdpgsw",
"https://www.youtube.com/watch?v=GNjStWG2vLU",
"https://www.youtube.com/watch?v=aSuqWWwNqZU",
"https://www.youtube.com/watch?v=UdxANCQcHXY",
"https://www.youtube.com/watch?v=YJK9ehfnoXU",
"https://www.youtube.com/watch?v=xvWBd4s_6zE",
"https://www.youtube.com/watch?v=XZmQfE9LvQM",
"https://www.youtube.com/watch?v=baW4Q-gbYm0",
"https://www.youtube.com/watch?v=HCpnhMH1vXs",
"https://www.youtube.com/watch?v=V0lB-kIooOg",
"https://www.youtube.com/watch?v=HnQSY3EyJ-w",
"https://www.youtube.com/watch?v=1GXzFdhYds4",
"https://www.youtube.com/watch?v=QpCiihgITgE",
"https://www.youtube.com/watch?v=nVjVoCs9hYQ",
"https://www.youtube.com/watch?v=1VL44pD_9vw",
"https://www.youtube.com/watch?v=PtVsSs81wRg",
"https://www.youtube.com/watch?v=frp2Fg5lgec",
"https://www.youtube.com/watch?v=heStP8sD110",
"https://www.youtube.com/watch?v=SdzAKQzn2go",
"https://www.youtube.com/watch?v=3ETnSyNGImY",
"https://www.youtube.com/watch?v=IaGsdnKORcA",
"https://www.youtube.com/watch?v=mWRa3-3UM0o",
"https://www.youtube.com/watch?v=Bw9j55bJtC8",
"https://www.youtube.com/watch?v=D9YoaznFUhw",
"https://www.youtube.com/watch?v=wXq5W0P6PEk",
"https://www.youtube.com/watch?v=hViNmzEIxFs",
"https://www.youtube.com/watch?v=TcVzaPcWNRQ",
"https://www.youtube.com/watch?v=4W9VYY5QpLg",
"https://www.youtube.com/watch?v=VWPG1W2r_VE",
"https://www.youtube.com/watch?v=IWtg_6bqfeA",
"https://www.youtube.com/watch?v=Un2xYzvAqhw",
"https://www.youtube.com/watch?v=AfAyfki40vc",
"https://www.youtube.com/watch?v=RRP_TlMhY04",
"https://www.youtube.com/watch?v=w3q-ps7LdXw",
"https://www.youtube.com/watch?v=qrTrpg6AHis",
"https://www.youtube.com/watch?v=VHbOsdaBBxs",
"https://www.youtube.com/watch?v=0F-V1OV7lIE",
"https://www.youtube.com/watch?v=vttTk86Dp_8",
"https://www.youtube.com/watch?v=V_aWst8kPXU",
"https://www.youtube.com/watch?v=RG1f1kpCZSU",
"https://www.youtube.com/watch?v=9cN1XCpfWD4",
"https://www.youtube.com/watch?v=8-1-MbpPn5Q",
"https://www.youtube.com/watch?v=iZ7fHmk6dwk",
"https://www.youtube.com/watch?v=T3f8UJlwf2o",
"https://www.youtube.com/watch?v=-IGmSbmX2WM",
"https://www.youtube.com/watch?v=stMx2V1xnz0",
"https://www.youtube.com/watch?v=1guGxZSZ3V0",
"https://www.youtube.com/watch?v=8s1wp8JvX4I",
"https://www.youtube.com/watch?v=O5V7yevYHeM",
"https://www.youtube.com/watch?v=1OijD72t4XY",
"https://www.youtube.com/watch?v=aLk4ORqjZ6c",
"https://www.youtube.com/watch?v=4aifzMWfNmg",
"https://www.youtube.com/watch?v=doUQgkNBRBQ",
"https://www.youtube.com/watch?v=isO-0ql0xfw",
"https://www.youtube.com/watch?v=p47xjw3nySk",
"https://www.youtube.com/watch?v=yCWibWOmWig",
"https://www.youtube.com/watch?v=Mspth_ex-pU",
"https://www.youtube.com/watch?v=TborQKEv3QI",
"https://www.youtube.com/watch?v=Hb-iP6G7IhY",
"https://www.youtube.com/watch?v=cMS1iMYuYx8",
"https://www.youtube.com/watch?v=syojVLQ8rck",
"https://www.youtube.com/watch?v=P0UQDWdnTIc",
"https://www.youtube.com/watch?v=Io8PqddrRIs",
"https://www.youtube.com/watch?v=XLvCseYvfaw",
"https://www.youtube.com/watch?v=K5Cuz3apNsg",
"https://www.youtube.com/watch?v=zv8fu8NhCTQ",
"https://www.youtube.com/watch?v=ZeHwynUVxBw",
"https://www.youtube.com/watch?v=r3mS0M88ZQE",
"https://www.youtube.com/watch?v=5_8MAhaoyVk",
"https://www.youtube.com/watch?v=jEfY53v4fjk",
"https://www.youtube.com/watch?v=kU0SJTmdFp4",
"https://www.youtube.com/watch?v=yBM0VH9iGjc",
"https://www.youtube.com/watch?v=IHoj7qvNmwk",
"https://www.youtube.com/watch?v=L4VU-AwxzSY",
"https://www.youtube.com/watch?v=yAv5pLO37mE",
"https://www.youtube.com/watch?v=y-26_30rDsg",
"https://www.youtube.com/watch?v=35OWaqIQwVw",
"https://www.youtube.com/watch?v=WrpBgN_iUnA",
"https://www.youtube.com/watch?v=01m1raOh6Js",
"https://www.youtube.com/watch?v=wxCsQsKn7O8",
"https://www.youtube.com/watch?v=H0emlFVOriQ",
"https://www.youtube.com/watch?v=Dpv5G0747V4",
"https://www.youtube.com/watch?v=wENxvYdSbgU",
"https://www.youtube.com/watch?v=DCi9I7ylt14",
"https://www.youtube.com/watch?v=d6wIEba35Ls",
"https://www.youtube.com/watch?v=nOVFnBvGaqk",
"https://www.youtube.com/watch?v=Z9LXv4JXIHM",
"https://www.youtube.com/watch?v=1Q-0uEw1ZbM",
"https://www.youtube.com/watch?v=WSdEOA2byf8",
"https://www.youtube.com/watch?v=j-yWv9lvSJs",
"https://www.youtube.com/watch?v=xF003aIVkuU",
"https://www.youtube.com/watch?v=8t20ZMxcboE",
"https://www.youtube.com/watch?v=wggVs0rRqds",
"https://www.youtube.com/watch?v=VsDLoYXVQJQ",
"https://www.youtube.com/watch?v=GjVwv6Nbqes",
"https://www.youtube.com/watch?v=DlmqLOq-YmU",
"https://www.youtube.com/watch?v=zK1g4LioyuE",
"https://www.youtube.com/watch?v=K6-vMfJrutg",
"https://www.youtube.com/watch?v=hKUY03drMoI",
"https://www.youtube.com/watch?v=gM9WzPEUqmY",
"https://www.youtube.com/watch?v=0zRx3NlFfsE",
"https://www.youtube.com/watch?v=af-CZzAWU6E",
"https://www.youtube.com/watch?v=Lkv2zF2Bgq0",
"https://www.youtube.com/watch?v=x-qvuB2clYw",
"https://www.youtube.com/watch?v=KnqNTjZaVnE",
"https://www.youtube.com/watch?v=-flCVYRmWz0",
"https://www.youtube.com/watch?v=N7iVWK2W48o",
"https://www.youtube.com/watch?v=Rl5uxK7Hkpg",
"https://www.youtube.com/watch?v=6e154lT94oU",
"https://www.youtube.com/watch?v=QL60uWjiXrw",
"https://www.youtube.com/watch?v=GB_S2qFh5lU",
"https://www.youtube.com/watch?v=fUMaNuKNLrQ",
"https://www.youtube.com/watch?v=puvQnGNVlRc",
"https://www.youtube.com/watch?v=4NRXx6U8ABQ",
"https://www.youtube.com/watch?v=lxLBuvFADhw",
"https://www.youtube.com/watch?v=o71ggIZ1CAk",
"https://www.youtube.com/watch?v=OeCS-DZsgKM",
"https://www.youtube.com/watch?v=U1vGosMScjM",
"https://www.youtube.com/watch?v=fHI8X4OXluQ",
"https://www.youtube.com/watch?v=pViBObCQEuA",
"https://www.youtube.com/watch?v=l0xhhG1Hyos",
"https://www.youtube.com/watch?v=d1BJe5rmySU",
"https://www.youtube.com/watch?v=SahRw77yvx0",
"https://www.youtube.com/watch?v=xXp4GnC1Z3Q",
"https://www.youtube.com/watch?v=6K0AmeM3BCQ",
"https://www.youtube.com/watch?v=vfkq-Ov7WSw",
"https://www.youtube.com/watch?v=jp-CVYGEsjg",
"https://www.youtube.com/watch?v=tpmawc8gAjY",
"https://www.youtube.com/watch?v=sOYICwnPjQM",
"https://www.youtube.com/watch?v=8WpUcsQMz5M",
"https://www.youtube.com/watch?v=7-x3uD5z1bQ",
"https://www.youtube.com/watch?v=qCTMq7xvdXU",
"https://www.youtube.com/watch?v=b5Zay_Hd_7Q",
"https://www.youtube.com/watch?v=x62B8FgaGOI",
"https://www.youtube.com/watch?v=pacSwYt-wR4",
"https://www.youtube.com/watch?v=Im2qYxxYvH4",
"https://www.youtube.com/watch?v=4tKmSTd8yfM",
"https://www.youtube.com/watch?v=ni3gmp-VQOM",
"https://www.youtube.com/watch?v=UMkCkPzbLYI",
"https://www.youtube.com/watch?v=5BD3pe2VYiE",
"https://www.youtube.com/watch?v=2qS5KsfHio8",
"https://www.youtube.com/watch?v=TNO40mDaOEY",
"https://www.youtube.com/watch?v=qV9i0LgoOKY",
"https://www.youtube.com/watch?v=605TgxtzGSU",
"https://www.youtube.com/watch?v=Aw56iIqbGkM",
"https://www.youtube.com/watch?v=5Trs5zLZKyw",
"https://www.youtube.com/watch?v=3bf3-c8YUrU",
"https://www.youtube.com/watch?v=xqqWsrfsktY",
"https://www.youtube.com/watch?v=h8xZje1jbI0",
"https://www.youtube.com/watch?v=hpevAiTMjdk",
"https://www.youtube.com/watch?v=lx15g64yI6A",
"https://www.youtube.com/watch?v=JXjQOHlc_aU",
"https://www.youtube.com/watch?v=UdFNGioq4TA",
"https://www.youtube.com/watch?v=Rg0rGmrIoNo",
"https://www.youtube.com/watch?v=c9K9bSaFz_U",
"https://www.youtube.com/watch?v=TJPvX4BCjD0",
"https://www.youtube.com/watch?v=sC0xkQA38t4",
"https://www.youtube.com/watch?v=XpT40Vy7RAk",
"https://www.youtube.com/watch?v=h28128Jotwk",
"https://www.youtube.com/watch?v=-JINOFq1bkg",
"https://www.youtube.com/watch?v=5bpUKFUKCPI",
"https://www.youtube.com/watch?v=Io2hbcrAYBw",
"https://www.youtube.com/watch?v=dAP4B1G-SWk",
"https://www.youtube.com/watch?v=7XvFr9Zqny0",
"https://www.youtube.com/watch?v=SE7umozOhtE",
"https://www.youtube.com/watch?v=mDvUwvk4QmU",
"https://www.youtube.com/watch?v=cM80j1AuSuo",
"https://www.youtube.com/watch?v=bYu-YHg1D7A",
"https://www.youtube.com/watch?v=4hZ_wTx_kWg",
"https://www.youtube.com/watch?v=oygrmJFKYZY",
"https://www.youtube.com/watch?v=LvBcTEhDumw",
"https://www.youtube.com/watch?v=KA07g2lvgbo",
"https://www.youtube.com/watch?v=zlJDTxahav0",
"https://www.youtube.com/watch?v=bRpN4hjXUuE",
"https://www.youtube.com/watch?v=Q_ovUTp40V8",
"https://www.youtube.com/watch?v=Km7Gjxbugrw",
"https://www.youtube.com/watch?v=SlPhMPnQ58k",
"https://www.youtube.com/watch?v=Nym5stAJAt8",
"https://www.youtube.com/watch?v=EpzCM3ozg-8",
"https://www.youtube.com/watch?v=CMla2ZIz7-4",
"https://www.youtube.com/watch?v=pFp05alGLow",
"https://www.youtube.com/watch?v=1OxOHtD0RDw",
"https://www.youtube.com/watch?v=6OLp72eLLc4",
"https://www.youtube.com/watch?v=Pkh8UtuejGw",
"https://www.youtube.com/watch?v=58MZrtoXSN4",
"https://www.youtube.com/watch?v=bXwJHdpwtvs",
"https://www.youtube.com/watch?v=wXhTHyIgQ_U",
"https://www.youtube.com/watch?v=Nde9oWyZsck",
"https://www.youtube.com/watch?v=-kQVnqVwz_A",
"https://www.youtube.com/watch?v=9KKOTIKkA7w",
"https://www.youtube.com/watch?v=N_qFfQ3xHCw",
"https://www.youtube.com/watch?v=_p7Jyyp_nDM",
"https://www.youtube.com/watch?v=TNN1viNe1Hw",
"https://www.youtube.com/watch?v=V2xE866febM",
"https://www.youtube.com/watch?v=qolmz4FlnZ0",
"https://www.youtube.com/watch?v=JR49dyo-y0E",
"https://www.youtube.com/watch?v=huwZ1bMYhLI",
"https://www.youtube.com/watch?v=NzdUeJnn0gM",
"https://www.youtube.com/watch?v=JWeJHN5P-E8",
"https://www.youtube.com/watch?v=2Vx8TDX6VVA",
"https://www.youtube.com/watch?v=DyDfgMOUjCI",
"https://www.youtube.com/watch?v=FKXSh14svlQ",
"https://www.youtube.com/watch?v=Ml_0bNKkozU",
"https://www.youtube.com/watch?v=5DcrRJI_H04",
"https://www.youtube.com/watch?v=rsEeiIrJy4E",
"https://www.youtube.com/watch?v=q0hyYWKXF0Q",
"https://www.youtube.com/watch?v=D6UTHCzUlAo",
"https://www.youtube.com/watch?v=Dkk9gvTmCXY",
"https://www.youtube.com/watch?v=29a6o5vRKVM",
"https://www.youtube.com/watch?v=PmYypVozQb4",
"https://www.youtube.com/watch?v=UZwi9SHgzGY",
"https://www.youtube.com/watch?v=1-MjOZN5uFg",
"https://www.youtube.com/watch?v=JGPB_IvmAJI",
"https://www.youtube.com/watch?v=ZEWGyyLiqY4",
"https://www.youtube.com/watch?v=j_A8Zjwr9m0",
"https://www.youtube.com/watch?v=zIXnT0s0f3s",
"https://www.youtube.com/watch?v=vpbblMR_jUo",
"https://www.youtube.com/watch?v=5Yz2t1QeIHQ",
"https://www.youtube.com/watch?v=KIGNNOZ0948",
"https://www.youtube.com/watch?v=ZAfAud_M_mg",
"https://www.youtube.com/watch?v=G55GspnNkBo",
"https://www.youtube.com/watch?v=vciZvVJyNYU",
"https://www.youtube.com/watch?v=CnAmeh0-E-U",
"https://www.youtube.com/watch?v=UYwF-jdcVjY",
"https://www.youtube.com/watch?v=bCuhuePlP8o",
"https://www.youtube.com/watch?v=4h26oYuE2h0",
"https://www.youtube.com/watch?v=Xzaxx1__ZPI",
"https://www.youtube.com/watch?v=_BWPNPtsZm8",
"https://www.youtube.com/watch?v=Wf5hcTwFveg",
"https://www.youtube.com/watch?v=ffNKpDkxzW8",
"https://www.youtube.com/watch?v=BG291cCNU3E",
"https://www.youtube.com/watch?v=PZpy02laS-c",
"https://www.youtube.com/watch?v=koJ1cAMfU3k",
"https://www.youtube.com/watch?v=XSskTLXMPJQ",
"https://www.youtube.com/watch?v=vNsXdvkMI7I",
"https://www.youtube.com/watch?v=AyCrypt1pdI",
"https://www.youtube.com/watch?v=ApXoWvfEYVU",
"https://www.youtube.com/watch?v=xpJLBnptJXA",
"https://www.youtube.com/watch?v=nuckTcoZG4Q",
"https://www.youtube.com/watch?v=s_8gG-7Djns",
"https://www.youtube.com/watch?v=QHqTBHZ59DA",
"https://www.youtube.com/watch?v=mr1VJRxeb9c",
"https://www.youtube.com/watch?v=za8Ki4CCXgg",
"https://www.youtube.com/watch?v=sIaT8Jl2zpI",
"https://www.youtube.com/watch?v=sOc7_Jv0czY",
"https://www.youtube.com/watch?v=JtYa0rb_jGQ",
"https://www.youtube.com/watch?v=FLzbKm56dLI",
"https://www.youtube.com/watch?v=2Q466ZPyNAo",
"https://www.youtube.com/watch?v=xAdZk30NiQw",
"https://www.youtube.com/watch?v=BVRnLUMeAoQ",
"https://www.youtube.com/watch?v=viimfQi_pUw",
"https://www.youtube.com/watch?v=gmX-ceF-N1k",
"https://www.youtube.com/watch?v=UPjvhk7I7eQ",
"https://www.youtube.com/watch?v=H7TZ0L26KSs",
"https://www.youtube.com/watch?v=7d29TtwHgeA",
"https://www.youtube.com/watch?v=E8gmARGvPlI",
"https://www.youtube.com/watch?v=PN0RPWII7gY",
"https://www.youtube.com/watch?v=etn4P80K5WU",
"https://www.youtube.com/watch?v=b0eFx5a-FMg",
"https://www.youtube.com/watch?v=WUsQbri9yaI",
"https://www.youtube.com/watch?v=zHKsTx0EzGg",
"https://www.youtube.com/watch?v=dMtnWxHbyQA",
"https://www.youtube.com/watch?v=LoIIkt5SXE0",
"https://www.youtube.com/watch?v=FkKGsSGDtQ0",
"https://www.youtube.com/watch?v=M-JiB7oJYxM",
"https://www.youtube.com/watch?v=A5SobvVUFYs",
"https://www.youtube.com/watch?v=71fjgVAj7gU",
"https://www.youtube.com/watch?v=d6GJeap4Oqo",
"https://www.youtube.com/watch?v=swSytFVMHuU",
"https://www.youtube.com/watch?v=dMuL0uHJrv4",
"https://www.youtube.com/watch?v=dM3mpUHwZOg",
"https://www.youtube.com/watch?v=wB9YIsKIEbA",
"https://www.youtube.com/watch?v=4eZ1Qatj69k",
"https://www.youtube.com/watch?v=-cXrEPNvRO8",
"https://www.youtube.com/watch?v=NhheiPTdZCw",
"https://www.youtube.com/watch?v=nD3iG6m44g8",
"https://www.youtube.com/watch?v=zVr7P2Cngiw",
"https://www.youtube.com/watch?v=4bIzs18GCB4",
"https://www.youtube.com/watch?v=1n4VJTuYAOY",
"https://www.youtube.com/watch?v=3j4I0PqNzKE",
"https://www.youtube.com/watch?v=NRWUoDpo2fo",
"https://www.youtube.com/watch?v=-C_3eYj-pOM",
"https://www.youtube.com/watch?v=425GpjTSlS4",
"https://www.youtube.com/watch?v=I_izvAbhExY",
"https://www.youtube.com/watch?v=gnskhYy15mE",
"https://www.youtube.com/watch?v=BcWlHQ6EzFk",
"https://www.youtube.com/watch?v=MR4Ik4RflVU",
"https://www.youtube.com/watch?v=BgP9tzt9_Z8",
"https://www.youtube.com/watch?v=oowC0tj6eEY",
"https://www.youtube.com/watch?v=wVrCZOiDlDo",
"https://www.youtube.com/watch?v=2EaflX0MWRo",
"https://www.youtube.com/watch?v=izzKUoxL11E",
"https://www.youtube.com/watch?v=Gs069dndIYk",
"https://www.youtube.com/watch?v=rDBbaGCCIhk"
)
and
datasources.Valid =1
ORDER BY SourceURI
) as t1
) as t2
where
row_num = 1
) as joy_xinh on joy_xinh.SourceURI = videos_youtubeurl.youtubeurl
-- close joy_xinh
where 
users.id = '253837945289294'
and
collections.valid = 1
and
collection_datasource.DatasourceId is NULL
ORDER BY videos.CreatedAt DESC
